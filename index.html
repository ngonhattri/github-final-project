<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√°o C√°o T√†i Ch√≠nh ƒê√°m C∆∞·ªõi</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Be+Vietnam+Pro:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
    <style>
        :root {
            --primary: #1e3a5f;
            --primary-light: #2d5a8a;
            --primary-dark: #0f2540;
            --accent: #c49a6c;
            --accent-light: #d4b896;
            --accent-dark: #a07d52;
            --bg-light: #f8f9fa;
            --bg-card: #ffffff;
            --text-dark: #1a1a2e;
            --text-muted: #6c757d;
            --success: #2d6a4f;
            --danger: #9b2c2c;
            --border: #e9ecef;
            --shadow: rgba(30, 58, 95, 0.08);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Be Vietnam Pro', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-light);
            min-height: 100vh;
            color: var(--text-dark);
            line-height: 1.7;
            font-size: 15px;
            -webkit-font-smoothing: antialiased;
        }
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 3rem 2rem;
            text-align: center;
        }
        header h1 {
            font-family: 'Playfair Display', Georgia, serif;
            font-size: 2.8rem;
            font-weight: 600;
            color: #fff;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }
        header p {
            color: var(--accent-light);
            font-weight: 400;
            font-size: 1rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
        }
        .decorative-line {
            width: 80px;
            height: 3px;
            background: var(--accent);
            margin: 1.2rem auto;
            border-radius: 2px;
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 2rem; }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2.5rem;
        }
        .summary-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.75rem;
            box-shadow: 0 2px 12px var(--shadow);
            border: 1px solid var(--border);
            position: relative;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .summary-card:hover { transform: translateY(-2px); box-shadow: 0 4px 20px var(--shadow); }
        .summary-card .icon {
            width: 48px; height: 48px;
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        .summary-card.income .icon { background: rgba(45, 106, 79, 0.1); color: var(--success); }
        .summary-card.expense .icon { background: rgba(155, 44, 44, 0.1); color: var(--danger); }
        .summary-card.balance .icon { background: rgba(30, 58, 95, 0.1); color: var(--primary); }
        .summary-card.foreign .icon { background: rgba(196, 154, 108, 0.1); color: var(--accent-dark); }
        .summary-card .label {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        .summary-card .value {
            font-family: 'Be Vietnam Pro', sans-serif;
            font-size: 1.85rem;
            font-weight: 700;
            color: var(--text-dark);
        }
        .summary-card.income .value { color: var(--success); }
        .summary-card.expense .value { color: var(--danger); }
        .summary-card.balance .value { color: var(--primary); }
        .summary-card .sub-info {
            font-size: 0.82rem;
            color: var(--text-muted);
            margin-top: 0.4rem;
        }
        .tabs { display: flex; gap: 0.5rem; margin-bottom: 2rem; flex-wrap: wrap; }
        .tab-btn {
            padding: 0.85rem 1.75rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            font-family: 'Be Vietnam Pro', sans-serif;
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .tab-btn:hover { border-color: var(--primary); color: var(--primary); }
        .tab-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: #fff;
        }
        .tab-content { display: none; animation: fadeIn 0.3s ease; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(420px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .chart-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 12px var(--shadow);
            border: 1px solid var(--border);
        }
        .chart-card h3 {
            font-family: 'Be Vietnam Pro', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 1.25rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border);
        }
        .chart-container { position: relative; height: 320px; }
        .chart-container.tall { height: 400px; }
        .filters { display: flex; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap; align-items: center; }
        .filter-group { display: flex; align-items: center; gap: 0.5rem; }
        .filter-group label { font-size: 0.85rem; font-weight: 500; color: var(--text-muted); }
        select, input[type="text"] {
            padding: 0.65rem 1rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-family: 'Be Vietnam Pro', sans-serif;
            font-size: 0.9rem;
            background: var(--bg-card);
            color: var(--text-dark);
            min-width: 150px;
            transition: border-color 0.2s;
        }
        select:focus, input[type="text"]:focus { outline: none; border-color: var(--primary); }
        .table-wrapper {
            background: var(--bg-card);
            border-radius: 12px;
            box-shadow: 0 2px 12px var(--shadow);
            border: 1px solid var(--border);
            overflow: hidden;
        }
        .table-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
            background: var(--bg-light);
        }
        .table-header h3 {
            font-family: 'Be Vietnam Pro', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
        }
        .table-stats { display: flex; gap: 2rem; }
        .table-stats span { font-size: 0.85rem; color: var(--text-muted); }
        .table-stats strong { color: var(--text-dark); font-weight: 600; }
        .table-scroll { overflow-x: auto; max-height: 600px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; }
        thead { position: sticky; top: 0; background: var(--bg-light); z-index: 10; }
        th {
            padding: 0.9rem 1.25rem;
            text-align: left;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            border-bottom: 2px solid var(--border);
            cursor: pointer;
            white-space: nowrap;
        }
        th:hover { color: var(--primary); }
        th.sorted { color: var(--primary); }
        td { padding: 0.9rem 1.25rem; border-bottom: 1px solid var(--border); font-size: 0.9rem; }
        tr:hover { background: var(--bg-light); }
        .money { font-weight: 600; color: var(--success); }
        .money.expense { color: var(--danger); }
        .badge {
            display: inline-block;
            padding: 0.25rem 0.7rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        .badge.nha-trai { background: rgba(45, 106, 79, 0.1); color: var(--success); }
        .badge.nha-gai { background: rgba(155, 44, 44, 0.1); color: var(--danger); }
        .badge.category { background: rgba(30, 58, 95, 0.1); color: var(--primary); }
        .foreign-currency { background: rgba(196, 154, 108, 0.08); }
        @media (max-width: 768px) {
            header h1 { font-size: 2rem; }
            .container { padding: 1rem; }
            .summary-card .value { font-size: 1.5rem; }
            .charts-grid { grid-template-columns: 1fr; }
            .chart-container { height: 280px; }
            .tab-btn { padding: 0.65rem 1rem; font-size: 0.85rem; }
            th, td { padding: 0.7rem 0.9rem; font-size: 0.8rem; }
        }
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-light); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }
    </style>
</head>
<body>
    <header>
        <h1>B√°o C√°o T√†i Ch√≠nh</h1>
        <div class="decorative-line"></div>
        <p>Wedding Financial Report</p>
    </header>
    <div class="container">
        <div class="summary-grid">
            <div class="summary-card income">
                <div class="icon">üìà</div>
                <div class="label">T·ªïng Ti·ªÅn M·ª´ng</div>
                <div class="value" id="totalIncome">0</div>
                <div class="sub-info" id="incomeInfo">0 kh√°ch</div>
            </div>
            <div class="summary-card expense">
                <div class="icon">üìâ</div>
                <div class="label">T·ªïng Chi Ph√≠</div>
                <div class="value" id="totalExpense">0</div>
                <div class="sub-info" id="expenseInfo">0 h·∫°ng m·ª•c</div>
            </div>
            <div class="summary-card balance">
                <div class="icon">üí∞</div>
                <div class="label">C√¢n ƒê·ªëi</div>
                <div class="value" id="balance">0</div>
                <div class="sub-info" id="balanceInfo">C√≤n l·∫°i sau chi ti√™u</div>
            </div>
            <div class="summary-card foreign">
                <div class="icon">üíµ</div>
                <div class="label">Ti·ªÅn M·ª´ng Ngo·∫°i T·ªá</div>
                <div class="value" id="foreignCurrency">0</div>
                <div class="sub-info" id="foreignInfo">Quy ƒë·ªïi tham kh·∫£o</div>
            </div>
        </div>
        <div class="tabs">
            <button class="tab-btn active" data-tab="overview">T·ªïng Quan</button>
            <button class="tab-btn" data-tab="income">Ti·ªÅn M·ª´ng</button>
            <button class="tab-btn" data-tab="expense">Chi Ti√™u</button>
        </div>
        <div class="tab-content active" id="overview">
            <div class="charts-grid">
                <div class="chart-card">
                    <h3>üìä Ti·ªÅn M·ª´ng: Nh√† Trai vs Nh√† G√°i</h3>
                    <div class="chart-container"><canvas id="incomeChart"></canvas></div>
                </div>
                <div class="chart-card">
                    <h3>üìã Chi Ph√≠ Theo H·∫°ng M·ª•c</h3>
                    <div class="chart-container tall"><canvas id="expenseChart"></canvas></div>
                </div>
                <div class="chart-card">
                    <h3>üèÜ Top 10 Ti·ªÅn M·ª´ng Cao Nh·∫•t</h3>
                    <div class="chart-container tall"><canvas id="topGiftsChart"></canvas></div>
                </div>
                <div class="chart-card">
                    <h3>üìâ Top 10 Ti·ªÅn M·ª´ng Th·∫•p Nh·∫•t</h3>
                    <div class="chart-container tall"><canvas id="bottomGiftsChart"></canvas></div>
                </div>
            </div>
        </div>
        <div class="tab-content" id="income">
            <div class="filters">
                <div class="filter-group">
                    <label>B√™n:</label>
                    <select id="sideFilter">
                        <option value="all">T·∫•t c·∫£</option>
                        <option value="Nh√† trai">Nh√† trai</option>
                        <option value="Nh√† g√°i">Nh√† g√°i</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>M·ª©c ti·ªÅn:</label>
                    <select id="amountFilter">
                        <option value="all">T·∫•t c·∫£</option>
                        <option value="under500">D∆∞·ªõi 500k</option>
                        <option value="500to1000">500k - 1 tri·ªáu</option>
                        <option value="1000to2000">1 - 2 tri·ªáu</option>
                        <option value="2000to5000">2 - 5 tri·ªáu</option>
                        <option value="over5000">Tr√™n 5 tri·ªáu</option>
                        <option value="foreign">Ngo·∫°i t·ªá</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>T√¨m ki·∫øm:</label>
                    <input type="text" id="searchInput" placeholder="T√™n kh√°ch...">
                </div>
            </div>
            <div class="table-wrapper">
                <div class="table-header">
                    <h3>Danh S√°ch Ti·ªÅn M·ª´ng</h3>
                    <div class="table-stats">
                        <span>T·ªïng: <strong id="filteredCount">0</strong> kh√°ch</span>
                        <span>S·ªë ti·ªÅn: <strong id="filteredTotal">0</strong></span>
                    </div>
                </div>
                <div class="table-scroll">
                    <table id="incomeTable">
                        <thead>
                            <tr>
                                <th data-sort="index">#</th>
                                <th data-sort="side">B√™n</th>
                                <th data-sort="guest">Nh√† Kh√°ch</th>
                                <th data-sort="people">S·ªë Ng∆∞·ªùi</th>
                                <th data-sort="amount">Ti·ªÅn M·ª´ng</th>
                                <th data-sort="note">Ch√∫ Th√≠ch</th>
                            </tr>
                        </thead>
                        <tbody id="incomeBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="tab-content" id="expense">
            <div class="filters">
                <div class="filter-group">
                    <label>H·∫°ng m·ª•c:</label>
                    <select id="categoryFilter"><option value="all">T·∫•t c·∫£</option></select>
                </div>
                <div class="filter-group">
                    <label>Ng∆∞·ªùi chi:</label>
                    <select id="payerFilter"><option value="all">T·∫•t c·∫£</option></select>
                </div>
            </div>
            <div class="table-wrapper">
                <div class="table-header">
                    <h3>Chi Ti·∫øt Chi Ti√™u</h3>
                    <div class="table-stats">
                        <span>T·ªïng: <strong id="expenseFilteredCount">0</strong> m·ª•c</span>
                        <span>S·ªë ti·ªÅn: <strong id="expenseFilteredTotal">0</strong></span>
                    </div>
                </div>
                <div class="table-scroll">
                    <table id="expenseTable">
                        <thead>
                            <tr>
                                <th data-sort="index">#</th>
                                <th data-sort="category">H·∫°ng M·ª•c</th>
                                <th data-sort="detail">Chi Ti·∫øt</th>
                                <th data-sort="planned">Ng∆∞·ªùi Chi</th>
                                <th data-sort="actual">Th·ª±c T·∫ø</th>
                                <th data-sort="vendor">ƒê∆°n V·ªã</th>
                                <th data-sort="remaining">C√≤n L·∫°i</th>
                            </tr>
                        </thead>
                        <tbody id="expenseBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script>
        const USD_TO_VND = 25000;
        const AUD_TO_VND = 16000;
        
        const incomeData = [
            {side: "Nh√† trai", guest: "anh An (Sun*)", people: 0, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "em Thu·ª≥ Trang (Sun*)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n M·ªπ Linh (A15)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "ch·ªã Ly", people: 0, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "ch·ªã Thu Anh (Sun*)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "ch·ªã Ho√†ng Anh (Sun*)", people: 1, amount: 700000, note: ""},
            {side: "Nh√† trai", guest: "em V∆∞∆°ng Ng·ªçc (Sun*)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "gƒë ch·ªã Li·ªÖu", people: 4, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë Tr√∫c L·ªõn", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Thu·ª≥ Anh", people: 0, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Nh√†n (JP)", people: 2, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "d√¨ Dung (x√≥m)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "b√† ngo·∫°i", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "b√°c Ph∆∞·ªõc (b·∫°n ba)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë √öt Nh√†n", people: 3, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë anh H·∫£i", people: 2, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "ch·ªã H√† (Tonichi)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "M·ªπ Ng·ªçc (JP)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "d√¨ Dung (B√¨nh D∆∞∆°ng)", people: 2, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "anh B·∫£o (B√¨nh D∆∞∆°ng)", people: 0, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "gƒë d√¨ √∫t Hi·ªáp", people: 3, amount: 5000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Th·∫Øm", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n T√†i V≈© (HUTECH)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "anh Qu√Ω (Gin)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë c√¥ An", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "anh 2 T√¢m", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "vc anh Th√°i q8", people: 2, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "anh Qu·ªõi (Sun*)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë D∆∞·ª£ng 2", people: 1, amount: 3000000, note: ""},
            {side: "Nh√† trai", guest: "b√°c Ba", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë anh Quy·ªÅn", people: 4, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "vc Ti·∫øn q8", people: 2, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Thu Ng√¢n (A15)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë anh Ch·∫£y", people: 0, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "gƒë ch√∫ Tu·∫•n", people: null, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "gƒë d√¨ Thu·ª∑", people: 2, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "anh Th√†nh (Sun*)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "gƒë anh Chinh ch·ªã Quy√™n", people: 4, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë anh Qu√Ω ch·ªã Thu√Ω", people: 3, amount: 3000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Ph√πng (HUTECH)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "c·∫≠u √öt Ho√†", people: 2, amount: 5000000, note: ""},
            {side: "Nh√† trai", guest: "tr∆∞·ªùng huy (A6)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "konaka", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë anh Tr√≠ L·ªõn", people: 2, amount: 5000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Minh H√¢n (A15)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "vc Sang q8", people: 2, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Tr√¢m", people: 2, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "ch·ªã Ph∆∞·ª£ng", people: null, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë ch√∫ Qu·ªëc (b·∫°n ba)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Nh·∫≠t T√∫ (HUTECH)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "chi Duy√™n (GC)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "ch·ªã Th·ª•c Y√™n (Tonichi)", people: 1, amount: 800000, note: ""},
            {side: "Nh√† trai", guest: "em Ph∆∞∆°ng Vy (HUTECH)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "Th·∫ßy Huy (A15)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Ph√∫c A6", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Duy + C·∫£nh (HUTECH)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "anh Ph√∫c(GC)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "b√°c ch√≠n (x√≥m)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n L·ªÖ (A15)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Phong (HUTECH)", people: 1, amount: 502000, note: ""},
            {side: "Nh√† trai", guest: "ch√∫ Hu·∫•n", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "b√°c B√¨nh (b·∫°n ba)", people: null, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë d√¨ Oanh", people: null, amount: 300000, note: ""},
            {side: "Nh√† trai", guest: "em Ng·ªçc H√† (HUTECH)", people: 1, amount: 700000, note: ""},
            {side: "Nh√† trai", guest: "ch·ªã Linh (B√¨nh D∆∞∆°ng)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "c·∫≠u ba (B√¨nh D∆∞∆°ng)", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "d√¨ Tuy·∫øt", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "em Thu H√† (Sun*)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "em Ph√∫c An (Tonichi)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n T√πng (HVT)", people: 0, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n M·ªπ Ng√¢n (A15)", people: 2, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë b√°c √öt (x√≥m)", people: 2, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "b√°c ba (GC)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "gƒë c·∫≠u Nghi√™m", people: 2, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "b√† (x√≥m)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "gƒë anh Ch√¢u (GC)", people: null, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "anh H·ªçc (Sun*)", people: 0, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "gƒë c√¥ H√†", people: 2, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Thu√Ω (HVT)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Ng√¢n (HVT)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Ho√†ng Anh", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "em Thanh ƒêan (Sun*)", people: 0, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "Vinh q8", people: 2, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n ƒê·ªÅ A6", people: 0, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "d√¨ Loan", people: 2, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "anh Long (GC)", people: null, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "Tr·ªçng D≈©ng (Sun*)", people: 0, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "ch·ªã Th·∫£o Quy√™n (Sun*)", people: 0, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "Minh L∆∞·ª£ng (Sun*)", people: 0, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "vc b·∫°n Minh Qu√¢n (HUTECH)", people: 1, amount: 2000000, note: ""},
            {side: "Nh√† trai", guest: "gƒë ch√∫ L√†i", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "ch·ªã B·∫£o Ch√¢u (Tonichi)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Ph∆∞∆°ng Lan (A6)", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Minh Th∆∞ + Th·ª•c Anh (A15)", people: 1, amount: 1300000, note: ""},
            {side: "Nh√† trai", guest: "b·∫°n Ng·ªçc Qu·ª≥nh (A15)", people: 2, amount: 1000000, note: ""},
            {side: "Nh√† trai", guest: "Ph∆∞∆°ng To√†n", people: 1, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "gƒë anh Nh√¢n", people: 3, amount: 3000000, note: ""},
            {side: "Nh√† trai", guest: "Khoa m·∫≠p JP", people: 0, amount: 1500000, note: ""},
            {side: "Nh√† trai", guest: "B·∫£o Khanh", people: 0, amount: 500000, note: ""},
            {side: "Nh√† trai", guest: "Mai Trinh (HUTECH)", people: 0, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "Mai Thanh + T√πng", people: 2, amount: 3000000, note: ""},
            {side: "Nh√† g√°i", guest: "gia ƒë√¨nh ch√°u S·ª©", people: 2, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gia ƒë√¨nh anh Nh√£ & c.H√†", people: 2, amount: 4000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë b·∫°n H√πng (New York School)", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "em Linh", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "em Khoa & Giang (T√≠)", people: 1, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh Nghƒ©a (LTK)", people: 2, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë B·∫°n D≈©ng", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh M·∫°nh (Nguy√™n C∆∞·ªùng Ph√°t)", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u K·ª≥", people: 1, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Qu√Ω", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Th·∫ø & Thu", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "c√¥ Sinh", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Th·∫£o (house Center)", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "anh Th√†nh", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Minh Ho√†ng", people: 3, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Ti·∫øn", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Long + Vy", people: 4, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u D≈©ng + Ph∆∞∆°ng", people: 4, amount: 3000000, note: ""},
            {side: "Nh√† g√°i", guest: "b·∫°n Ph∆∞·ª£ng", people: 1, amount: 3000000, note: ""},
            {side: "Nh√† g√°i", guest: "b·∫°n H·ªìng Khanh", people: 1, amount: 3000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh An", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Tri·ªÅu", people: 2, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u V≈© & c√°c ch√°u", people: 4, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em H·∫£i", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh ƒê·ª©c", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Ph∆∞·ª£ng T√¢y Ninh", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë b·∫°n Tu·∫•n", people: null, amount: 800000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Ho√†ng + Trang ( T√¢y Ninh)", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Trang", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Ti·∫øn", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh Ho√†", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Nam", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em L√¢m + Ph∆∞∆°ng", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em S∆°n", people: null, amount: 3000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Nh∆∞·ªùng (325/12 LVQ)", people: 1, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë b·∫°n Duy", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Hi·ªÅn (T√¢y Ninh)", people: 0, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "2 em T√πng Gia Ki·ªám", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Ch√¢u", people: 1, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch·ªã C∆° & c√°c ch√°u", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u ƒê√¥ng", people: 3, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh B√¨nh", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch·ªã T√¢n", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u C√¥ng", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "ch·ªã Kim", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Ph∆∞∆°ng", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em S·ª≠", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Vi·ªát", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh Tho·∫£", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "b·∫°n Thu", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Th√°i (BA Tam)", people: 4, amount: 5000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em B√¨nh", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "2 em thu + b√¨nh c√¥ Mi·ªán", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "2 em ch√¢u gia ki·ªám", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh ƒê·∫°t ch·ªã Sim", people: 3, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Lan", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë d√¨ Tuy·∫øt", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Trung + Ch√≠nh", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh Xu", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "ch√°u Nguy·ªát (T√¢y Ninh)", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u H√πng (USA)", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë Ch√°u H√πng (T√¢y Ninh)", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Quang & Ng·ªçc", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u M·∫´n", people: 4, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "ch·ªã √öt & ch·ªã T√°m", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "ch√°u H∆∞∆°ng", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Trung (400/1)", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u L∆∞u (T√¢y Ninh)", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh Ch·ªØ", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u T√πng + Trang", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh V√¢n", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em ƒê·ª©c", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh ƒê√¥", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Nh√†n", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë b·∫°n Qu√Ω", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "hai ch√°u Chung - Kh√¨n (Ph√∫ B√¨nh)", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em C∆∞·ªùng (Th√†nh Ph√°t)", people: null, amount: 3000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u S∆°n + Trang", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh Ho√† (399NGT)", people: null, amount: 1000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em ·ª®ng", people: null, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh Th√†nh", people: null, amount: 500000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Thu·ª∑", people: 1, amount: 3000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Nam + ch·ªã Hoa", people: 2, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh D∆∞∆°ng + ch·ªã Mai v√† ch√°u Qu√¢n", people: 1, amount: 3000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë em Th·∫Øng", people: 2, amount: 5000000, note: ""},
            {side: "Nh√† g√°i", guest: "ch·ªã N∆∞∆°ng", people: 1, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh K√≠nh", people: 1, amount: 3000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh Hi·∫øu + ch√°u B√¨nh", people: 3, amount: 4000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh Hi·ªáp", people: 2, amount: 2000000, note: ""},
            {side: "Nh√† g√°i", guest: "ch·ªã H∆∞·ªùng", people: 1, amount: 3000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh H√πng v√† c√°c ch√°u", people: 4, amount: 5000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh H·ªï v√† c√°c ch√°u", people: 4, amount: 10000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë anh ch·ªã Th√†nh Y·∫øn", people: 0, amount: 5000000, note: ""},
            {side: "Nh√† g√°i", guest: "gƒë ch√°u Duy + an (b√°c hai)", people: 4, amount: 5000000, note: ""},
            {side: "Nh√† g√°i", guest: "b√°c hai CMT8", people: 1, amount: 5000000, note: ""},
            {side: "Nh√† g√°i", guest: "b·∫°n Ho√†ng Anh", people: 0, amount: "100 ƒë√¥", note: "USD", isForeign: true, foreignValue: 100, foreignType: "USD"},
            {side: "Nh√† g√°i", guest: "ch√∫ Vi·ªán d√¨ Thu√Ω", people: 0, amount: "300 ƒë√¥", note: "USD", isForeign: true, foreignValue: 300, foreignType: "USD"},
            {side: "Nh√† g√°i", guest: "ch·ªã Nh√£", people: 0, amount: "50 ƒë√¥", note: "AUD", isForeign: true, foreignValue: 50, foreignType: "AUD"},
            {side: "Nh√† g√°i", guest: "ch·ªã VY", people: 0, amount: "500 ƒë√¥", note: "USD", isForeign: true, foreignValue: 500, foreignType: "USD"},
            {side: "Nh√† g√°i", guest: "gƒë em Nghƒ©a (c√¥ Nga)", people: 0, amount: "500 ƒë√¥", note: "USD", isForeign: true, foreignValue: 500, foreignType: "USD"},
            {side: "Nh√† g√°i", guest: "ch·ªã Th·∫£o Nguy√™n", people: 0, amount: "3000 ƒë√¥", note: "USD", isForeign: true, foreignValue: 3000, foreignType: "USD"},
            {side: "Nh√† g√°i", guest: "L√¢m B·∫£o Quy√™n", people: 0, amount: "200 ƒë√¥", note: "USD", isForeign: true, foreignValue: 200, foreignType: "USD"}
        ];
        const expenseData = [
            {category: "Trang ph·ª•c", detail: "V√°y c∆∞·ªõi c√¥ d√¢u", planned: "CR, CD", actual: 14500000, vendor: "L√™ Ho√†", remaining: 0},
            {category: "Trang ph·ª•c", detail: "Vest ch√∫ r·ªÉ (TUXEDO, n∆°, √°o s∆° mi)", planned: "CR", actual: 7000000, vendor: "Ch∆∞∆°ng", remaining: 0},
            {category: "Trang ph·ª•c", detail: "Gi√†y c√¥ d√¢u", planned: "CD", actual: 399000, vendor: "She Shoes", remaining: 0},
            {category: "Trang ph·ª•c", detail: "√Åo d√†i CD/CR", planned: "CR", actual: 3500000, vendor: "Chou", remaining: 0},
            {category: "Thi·ªáp m·ªùi", detail: "Thi·ªáp c∆∞·ªõi", planned: "CR", actual: 6700000, vendor: "peonies", remaining: 0},
            {category: "Thi·ªáp m·ªùi", detail: "Thi·ªáp c∆∞·ªõi online", planned: "CR", actual: 942000, vendor: "AZDIGI", remaining: 0},
            {category: "Media", detail: "Video chi·∫øu ti·ªác", planned: "CR", actual: 1200000, vendor: "Ch·ªã Vy", remaining: 0},
            {category: "H·ªôi tr∆∞·ªùng", detail: "Pavilion TSN - T·ªïng chi ph√≠", planned: "B·ªë m·∫π CR", actual: 188580000, vendor: "Pavillon TSN", remaining: 0},
            {category: "Trang tr√≠", detail: "Trang tr√≠ s√¢n kh·∫•u", planned: "CR", actual: 7000000, vendor: "M·∫¶M WEDDING", remaining: 0},
            {category: "Trang ƒëi·ªÉm", detail: "Make-up c√¥ d√¢u, ng∆∞·ªùi nh√†", planned: "B·ªë m·∫π CD", actual: 13700000, vendor: "SAMMY MAKEUP", remaining: 11700000},
            {category: "S√≠nh l·ªÖ", detail: "Tr√°p ƒÉn h·ªèi - n·∫°p t√†i", planned: "CR", actual: 6200000, vendor: "Elle flora", remaining: 0},
            {category: "S√≠nh l·ªÖ", detail: "L√¨ x√¨ ƒë·ªôi b√™ tr√°p", planned: "CR", actual: 1600000, vendor: "CR", remaining: 0},
            {category: "Di chuy·ªÉn", detail: "Thu√™ xe", planned: "CR", actual: 7800000, vendor: "C·∫≠u √∫t", remaining: 0},
            {category: "S√≠nh l·ªÖ", detail: "Trang ph·ª•c + thu√™ ƒë·ªôi b√™ tr√°p", planned: "CR", actual: 4500000, vendor: "C·∫≠u √∫t", remaining: 0},
            {category: "Trang tr√≠", detail: "Trang tr√≠ gia ti√™n nh√† trai", planned: "CR", actual: 21600000, vendor: "Gia Hi·∫øu + ch·ªã Uy√™n C√¥ H√†", remaining: 0},
            {category: "Trang tr√≠", detail: "Trang tr√≠ gia ti√™n nh√† g√°i", planned: "B·ªë m·∫π CD", actual: 30200000, vendor: "Gia Hi·∫øu + ch·ªã Uy√™n C√¥ H√†", remaining: 0},
            {category: "Media", detail: "Quay ch·ª•p ph√≥ng s·ª± c∆∞·ªõi (2 ng√†y)", planned: "CR", actual: 42000000, vendor: "Hayes", remaining: 0},
            {category: "D·ª•ng c·ª•", detail: "Ph√°o gi·∫•y, qu·∫°t, l√≥t gi√†y, m√≥c √°o", planned: "CR", actual: 342310, vendor: "Shopee", remaining: 0},
            {category: "ƒê·ªì c∆∞·ªõi", detail: "Nh·∫´n c·∫ßu h√¥n", planned: "CR", actual: 50000000, vendor: "PNJ", remaining: 0},
            {category: "ƒê·ªì c∆∞·ªõi", detail: "Trang s·ª©c c∆∞·ªõi", planned: "CR", actual: 43575000, vendor: "PNJ", remaining: 0},
            {category: "ƒê·ªì c∆∞·ªõi", detail: "Nh·∫´n c∆∞·ªõi", planned: "CD", actual: 48736000, vendor: "Ginza Diamond", remaining: 0},
            {category: "D·ª•ng c·ª•", detail: "Bao l√¨ x√¨ b√™ tr√°p", planned: "CR", actual: 100000, vendor: "She Shoes", remaining: 0},
            {category: "S√≠nh l·ªÖ", detail: "Tr√°i c√¢y, r∆∞·ª£u tr√†, m√¢m qu·∫£", planned: "B·ªë m·∫π CR", actual: 1800000, vendor: "C·∫≠u √∫t", remaining: 0},
            {category: "S√≠nh l·ªÖ", detail: "B√°nh phu th√™ + b√°nh c·ªëm", planned: "B·ªë m·∫π CR", actual: 1000000, vendor: "C·∫≠u √∫t", remaining: 0},
            {category: "S√≠nh l·ªÖ", detail: "Heo quay 8kg", planned: "B·ªë m·∫π CR", actual: 4200000, vendor: "C·∫≠u √∫t", remaining: 0},
            {category: "Ph√°t sinh kh√°c", detail: "L√¨ x√¨ ph·ª•c v·ª• nh√† h√†ng", planned: "B·ªë m·∫π CR", actual: 4400000, vendor: "C·∫≠u √∫t", remaining: 0},
            {category: "ƒÇn u·ªëng", detail: "Tr√°i c√¢y, b√°nh, n∆∞·ªõc (ƒë√£i nh√† g√°i)", planned: "B·ªë m·∫π CR", actual: 2500000, vendor: "C·∫≠u √∫t", remaining: 0}
        ];

        // Helper to convert to VND
        function toVND(item) {
            if (item.isForeign) {
                return item.foreignType === 'AUD' ? item.foreignValue * AUD_TO_VND : item.foreignValue * USD_TO_VND;
            }
            return item.amount;
        }

        function formatMoney(amount) {
            if (typeof amount === 'string') return amount;
            return new Intl.NumberFormat('vi-VN').format(amount) + 'ƒë';
        }
        
        function formatMoneyShort(amount) {
            if (amount >= 1000000) return (amount / 1000000).toFixed(1) + 'M';
            if (amount >= 1000) return (amount / 1000).toFixed(0) + 'K';
            return amount.toString();
        }

        function calculateTotals() {
            let vndTotal = 0, foreignUSD = 0, foreignAUD = 0, nhaTrai = 0, nhaGai = 0;
            incomeData.forEach(item => {
                if (item.isForeign) {
                    if (item.foreignType === 'AUD') foreignAUD += item.foreignValue;
                    else foreignUSD += item.foreignValue;
                } else {
                    vndTotal += item.amount;
                    if (item.side === 'Nh√† trai') nhaTrai += item.amount;
                    else nhaGai += item.amount;
                }
            });
            const expenseTotal = expenseData.reduce((sum, item) => sum + item.actual, 0);
            const foreignInVnd = (foreignUSD * USD_TO_VND) + (foreignAUD * AUD_TO_VND);
            document.getElementById('totalIncome').textContent = formatMoney(vndTotal);
            document.getElementById('incomeInfo').textContent = incomeData.length + ' kh√°ch ‚Ä¢ Nh√† trai: ' + formatMoney(nhaTrai) + ' ‚Ä¢ Nh√† g√°i: ' + formatMoney(nhaGai);
            document.getElementById('totalExpense').textContent = formatMoney(expenseTotal);
            document.getElementById('expenseInfo').textContent = expenseData.length + ' h·∫°ng m·ª•c';
            const diff = vndTotal - expenseTotal;
            document.getElementById('balance').textContent = formatMoney(Math.abs(diff));
            document.getElementById('balanceInfo').textContent = diff >= 0 ? 'Th·∫∑ng d∆∞' : 'Thi·∫øu h·ª•t';
            document.getElementById('foreignCurrency').textContent = '$' + foreignUSD.toLocaleString() + ' + A$' + foreignAUD;
            document.getElementById('foreignInfo').textContent = '‚âà ' + formatMoney(foreignInVnd) + ' (quy ƒë·ªïi)';
            return { vndTotal, nhaTrai, nhaGai, expenseTotal, foreignUSD, foreignAUD, foreignInVnd };
        }
        
        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                btn.classList.add('active');
                document.getElementById(btn.dataset.tab).classList.add('active');
            });
        });

        // Income table
        let currentIncomeSort = { field: null, asc: true };
        function renderIncomeTable(data) {
            const tbody = document.getElementById('incomeBody');
            tbody.innerHTML = '';
            let filteredTotal = 0;
            data.forEach((item, idx) => {
                const tr = document.createElement('tr');
                if (item.isForeign) tr.classList.add('foreign-currency');
                const amountDisplay = typeof item.amount === 'string' ? item.amount : formatMoney(item.amount);
                if (typeof item.amount === 'number') filteredTotal += item.amount;
                else if (item.isForeign) filteredTotal += toVND(item);
                tr.innerHTML = '<td>' + (idx + 1) + '</td><td><span class="badge ' + (item.side === 'Nh√† trai' ? 'nha-trai' : 'nha-gai') + '">' + item.side + '</span></td><td>' + item.guest + '</td><td>' + (item.people !== null ? item.people : '-') + '</td><td class="money">' + amountDisplay + '</td><td>' + (item.note || '-') + '</td>';
                tbody.appendChild(tr);
            });
            document.getElementById('filteredCount').textContent = data.length;
            document.getElementById('filteredTotal').textContent = formatMoney(filteredTotal);
        }
        function filterIncome() {
            const side = document.getElementById('sideFilter').value;
            const amount = document.getElementById('amountFilter').value;
            const search = document.getElementById('searchInput').value.toLowerCase();
            let filtered = incomeData.filter(item => {
                if (side !== 'all' && item.side !== side) return false;
                if (search && !item.guest.toLowerCase().includes(search)) return false;
                if (amount !== 'all') {
                    if (amount === 'foreign') return item.isForeign;
                    if (item.isForeign) return false;
                    const val = item.amount;
                    switch(amount) {
                        case 'under500': return val < 500000;
                        case '500to1000': return val >= 500000 && val <= 1000000;
                        case '1000to2000': return val > 1000000 && val <= 2000000;
                        case '2000to5000': return val > 2000000 && val <= 5000000;
                        case 'over5000': return val > 5000000;
                    }
                }
                return true;
            });
            if (currentIncomeSort.field) {
                filtered.sort((a, b) => {
                    let valA = a[currentIncomeSort.field], valB = b[currentIncomeSort.field];
                    if (currentIncomeSort.field === 'amount') { valA = toVND(a); valB = toVND(b); }
                    if (typeof valA === 'string') valA = valA.toLowerCase();
                    if (typeof valB === 'string') valB = valB.toLowerCase();
                    if (valA < valB) return currentIncomeSort.asc ? -1 : 1;
                    if (valA > valB) return currentIncomeSort.asc ? 1 : -1;
                    return 0;
                });
            }
            renderIncomeTable(filtered);
        }
        document.getElementById('sideFilter').addEventListener('change', filterIncome);
        document.getElementById('amountFilter').addEventListener('change', filterIncome);
        document.getElementById('searchInput').addEventListener('input', filterIncome);
        document.querySelectorAll('#incomeTable th').forEach(th => {
            th.addEventListener('click', () => {
                const field = th.dataset.sort;
                if (currentIncomeSort.field === field) currentIncomeSort.asc = !currentIncomeSort.asc;
                else { currentIncomeSort.field = field; currentIncomeSort.asc = true; }
                document.querySelectorAll('#incomeTable th').forEach(t => t.classList.remove('sorted'));
                th.classList.add('sorted');
                filterIncome();
            });
        });
        // Expense table
        let currentExpenseSort = { field: null, asc: true };
        function renderExpenseTable(data) {
            const tbody = document.getElementById('expenseBody');
            tbody.innerHTML = '';
            let filteredTotal = 0;
            data.forEach((item, idx) => {
                filteredTotal += item.actual;
                const tr = document.createElement('tr');
                tr.innerHTML = '<td>' + (idx + 1) + '</td><td><span class="badge category">' + item.category + '</span></td><td>' + item.detail + '</td><td>' + item.planned + '</td><td class="money expense">' + formatMoney(item.actual) + '</td><td>' + item.vendor + '</td><td class="' + (item.remaining > 0 ? 'money expense' : '') + '">' + (item.remaining > 0 ? formatMoney(item.remaining) : '‚úì') + '</td>';
                tbody.appendChild(tr);
            });
            document.getElementById('expenseFilteredCount').textContent = data.length;
            document.getElementById('expenseFilteredTotal').textContent = formatMoney(filteredTotal);
        }
        function filterExpense() {
            const category = document.getElementById('categoryFilter').value;
            const payer = document.getElementById('payerFilter').value;
            let filtered = expenseData.filter(item => {
                if (category !== 'all' && item.category !== category) return false;
                if (payer !== 'all' && item.planned !== payer) return false;
                return true;
            });
            if (currentExpenseSort.field) {
                filtered.sort((a, b) => {
                    let valA = a[currentExpenseSort.field], valB = b[currentExpenseSort.field];
                    if (typeof valA === 'string') valA = valA.toLowerCase();
                    if (typeof valB === 'string') valB = valB.toLowerCase();
                    if (valA < valB) return currentExpenseSort.asc ? -1 : 1;
                    if (valA > valB) return currentExpenseSort.asc ? 1 : -1;
                    return 0;
                });
            }
            renderExpenseTable(filtered);
        }
        const categories = [...new Set(expenseData.map(e => e.category))];
        const payers = [...new Set(expenseData.map(e => e.planned))];
        categories.forEach(cat => { document.getElementById('categoryFilter').innerHTML += '<option value="' + cat + '">' + cat + '</option>'; });
        payers.forEach(p => { document.getElementById('payerFilter').innerHTML += '<option value="' + p + '">' + p + '</option>'; });
        document.getElementById('categoryFilter').addEventListener('change', filterExpense);
        document.getElementById('payerFilter').addEventListener('change', filterExpense);
        document.querySelectorAll('#expenseTable th').forEach(th => {
            th.addEventListener('click', () => {
                const field = th.dataset.sort;
                if (currentExpenseSort.field === field) currentExpenseSort.asc = !currentExpenseSort.asc;
                else { currentExpenseSort.field = field; currentExpenseSort.asc = true; }
                document.querySelectorAll('#expenseTable th').forEach(t => t.classList.remove('sorted'));
                th.classList.add('sorted');
                filterExpense();
            });
        });

        // Charts
        function initCharts() {
            const totals = calculateTotals();
            
            // Professional color palette
            const colors = {
                primary: '#1e3a5f',
                secondary: '#2d5a8a',
                accent: '#c49a6c',
                success: '#2d6a4f',
                danger: '#9b2c2c',
                chart: ['#1e3a5f', '#2d6a4f', '#9b2c2c', '#c49a6c', '#6b7280', '#4a5568', '#2d5a8a', '#166534', '#7c2d12', '#d4a574', '#9ca3af', '#374151']
            };

            // Income pie chart
            new Chart(document.getElementById('incomeChart'), {
                type: 'doughnut',
                data: { 
                    labels: ['Nh√† Trai', 'Nh√† G√°i'], 
                    datasets: [{ 
                        data: [totals.nhaTrai, totals.nhaGai], 
                        backgroundColor: [colors.primary, colors.accent],
                        borderWidth: 0,
                        hoverOffset: 4
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { 
                            position: 'bottom', 
                            labels: { font: { family: "'Be Vietnam Pro', sans-serif", size: 12 }, padding: 20 } 
                        }, 
                        tooltip: { 
                            callbacks: { 
                                label: (ctx) => ctx.label + ': ' + formatMoney(ctx.raw) + ' (' + ((ctx.raw / totals.vndTotal) * 100).toFixed(1) + '%)'
                            } 
                        } 
                    },
                    cutout: '60%'
                }
            });

            // Expense by category - Horizontal Bar
            const expenseByCategory = {};
            expenseData.forEach(e => { expenseByCategory[e.category] = (expenseByCategory[e.category] || 0) + e.actual; });
            const sortedCategories = Object.entries(expenseByCategory).sort((a, b) => b[1] - a[1]);
            
            new Chart(document.getElementById('expenseChart'), {
                type: 'bar',
                data: { 
                    labels: sortedCategories.map(c => c[0]), 
                    datasets: [{ 
                        data: sortedCategories.map(c => c[1]), 
                        backgroundColor: colors.chart.slice(0, sortedCategories.length),
                        borderRadius: 4,
                        barThickness: 24
                    }] 
                },
                options: { 
                    indexAxis: 'y',
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { display: false }, 
                        tooltip: { 
                            callbacks: { 
                                label: (ctx) => formatMoney(ctx.raw) + ' (' + ((ctx.raw / totals.expenseTotal) * 100).toFixed(1) + '%)'
                            } 
                        } 
                    },
                    scales: {
                        x: { 
                            ticks: { 
                                font: { family: "'Be Vietnam Pro', sans-serif", size: 11 },
                                callback: (val) => formatMoneyShort(val)
                            },
                            grid: { color: '#e9ecef' }
                        },
                        y: { 
                            ticks: { font: { family: "'Be Vietnam Pro', sans-serif", size: 11 } },
                            grid: { display: false }
                        }
                    }
                }
            });

            // Convert all gifts to VND and sort
            const allGiftsVND = incomeData.map(item => ({
                ...item,
                amountVND: toVND(item),
                displayName: item.guest.length > 22 ? item.guest.substring(0, 22) + '...' : item.guest
            }));
            
            // Top 10 highest
            const topGifts = [...allGiftsVND].sort((a, b) => b.amountVND - a.amountVND).slice(0, 10);
            
            new Chart(document.getElementById('topGiftsChart'), {
                type: 'bar',
                data: { 
                    labels: topGifts.map(g => g.displayName), 
                    datasets: [{ 
                        data: topGifts.map(g => g.amountVND), 
                        backgroundColor: topGifts.map(g => g.isForeign ? colors.accent : colors.success),
                        borderRadius: 4,
                        barThickness: 28
                    }] 
                },
                options: { 
                    indexAxis: 'y', 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { display: false }, 
                        tooltip: { 
                            callbacks: { 
                                title: (ctx) => topGifts[ctx[0].dataIndex].guest,
                                label: (ctx) => {
                                    const item = topGifts[ctx.dataIndex];
                                    if (item.isForeign) {
                                        return item.amount + ' ‚âà ' + formatMoney(ctx.raw);
                                    }
                                    return formatMoney(ctx.raw);
                                }
                            } 
                        } 
                    }, 
                    scales: { 
                        x: { 
                            ticks: { 
                                font: { family: "'Be Vietnam Pro', sans-serif", size: 11 }, 
                                callback: (val) => formatMoneyShort(val) 
                            },
                            grid: { color: '#e9ecef' }
                        }, 
                        y: { 
                            ticks: { font: { family: "'Be Vietnam Pro', sans-serif", size: 11 } },
                            grid: { display: false }
                        } 
                    } 
                }
            });

            // Bottom 10 lowest
            const bottomGifts = [...allGiftsVND].sort((a, b) => a.amountVND - b.amountVND).slice(0, 10);
            
            new Chart(document.getElementById('bottomGiftsChart'), {
                type: 'bar',
                data: { 
                    labels: bottomGifts.map(g => g.displayName), 
                    datasets: [{ 
                        data: bottomGifts.map(g => g.amountVND), 
                        backgroundColor: bottomGifts.map(g => g.isForeign ? colors.accent : colors.danger),
                        borderRadius: 4,
                        barThickness: 28
                    }] 
                },
                options: { 
                    indexAxis: 'y', 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { display: false }, 
                        tooltip: { 
                            callbacks: { 
                                title: (ctx) => bottomGifts[ctx[0].dataIndex].guest,
                                label: (ctx) => {
                                    const item = bottomGifts[ctx.dataIndex];
                                    if (item.isForeign) {
                                        return item.amount + ' ‚âà ' + formatMoney(ctx.raw);
                                    }
                                    return formatMoney(ctx.raw);
                                }
                            } 
                        } 
                    }, 
                    scales: { 
                        x: { 
                            ticks: { 
                                font: { family: "'Be Vietnam Pro', sans-serif", size: 11 }, 
                                callback: (val) => formatMoneyShort(val) 
                            },
                            grid: { color: '#e9ecef' }
                        }, 
                        y: { 
                            ticks: { font: { family: "'Be Vietnam Pro', sans-serif", size: 11 } },
                            grid: { display: false }
                        } 
                    } 
                }
            });
        }

        // Initialize
        filterIncome();
        filterExpense();
        initCharts();
    </script>
</body>
</html>
